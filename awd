import numpy as np
import pandas as pd
import os
import matplotlib.pyplot as plt

os.chdir('C:\\Users\\andrz\\Desktop\\AWD')
file = 'Netflix Original Content Dataset.csv'

data = pd.read_csv(file)

'''
y2k13 = data[data['Year Released'] == 2013].nlargest(3, 'RT Audience Score')
y2k14 = data[data['Year Released'] == 2014].nlargest(2, 'RT Audience Score')
y2k15 = data[data['Year Released'] == 2015].nlargest(10, 'RT Audience Score')
y2k16 = data[data['Year Released'] == 2016].nlargest(10, 'RT Audience Score')
y2k17 = data[data['Year Released'] == 2017].nlargest(10, 'RT Audience Score')
y2k18 = data[data['Year Released'] == 2018].nlargest(10, 'RT Audience Score')
y2k19 = data[data['Year Released'] == 2019].nlargest(4, 'RT Audience Score')
'''
#Tresci jakiego gatunku ciesza sie najwiekszymi ocenami?

topGenre = data.groupby(['Genre']).mean()
topRTA = topGenre.nlargest(10,  'RT Audience Score')
topRTC = topGenre.nlargest(10,  'RT Critic Score')
topIMDb = topGenre.nlargest(10,  'IMDb Rating')
 
plt.figure(1)
plt.title('Mean RT Audience Score')
topRTA['RT Audience Score'].plot.barh()
plt.figure(2)
plt.title('Mean RT Critic Score')
topRTC['RT Critic Score'].plot.barh()
plt.figure(3)
plt.title('Mean IMDb Rating')
topIMDb['IMDb Rating'].plot.barh()


#Czy filmy o łagodniejszej klasyfikacji wiekowej częściej są animacjami? 

Animations = data[data['Animated'] == 'yes']
plt.figure(4)
plt.title('Categories of animated films')
Animations['Rating'].value_counts().plot.pie(figsize =(6,6),autopct='%1.1f%%')

#Czy typowym dla niektórych gatunków jest większa ilość sezonów czy nie, jeśli tak to dla jakich? 

Sezony = data.groupby(['Genre']).mean()
topSezony = Sezony.nlargest(10,'Seasons')
plt.figure(5)
plt.title('10 genres with most seasons')
topSezony['Seasons'].plot.barh().invert_yaxis()

#W jakich gatunkowo treściach główne role zajmują kobiety a w jakich mężczyźni, czy jest różnica?

roleMale = data[data['Main Actor'] == 'Male']
topMale = roleMale['Genre'].value_counts().nlargest(10)
plt.figure(6)
plt.title('10 most popular genres with male as main actor')
topMale.plot.pie(figsize = (6,6))

roleFemale = data[data['Main Actor'] == 'Female']
topFemale = roleFemale['Genre'].value_counts().nlargest(10)
plt.figure(7)
plt.title('10 most popular genres with female as main actress')
topFemale.plot.pie(figsize = (6,6))

#Jakie gatunki były najpopularniejsze w wybranych latach? 

Leader = data.groupby(['Year Released']).head(1).sort_values(['Year Released'], axis=0, ascending=True)
Reader = Leader.drop(['Seasons','Main Actor','International','Animated','Rating'],axis=1) 
column_labels = Reader.columns.tolist()
index_labels = Reader.index.tolist()


plt.subplot(911)
plt.table(cellText= Reader.values,colWidths = [0.25]*len(column_labels),
          rowLabels= index_labels,
          colLabels= column_labels,
          cellLoc = 'center', rowLoc = 'center',
          loc='top')
fig = plt.gcf()
